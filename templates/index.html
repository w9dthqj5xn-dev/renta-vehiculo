<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Renta de Veh√≠culos</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Sistema completo de gesti√≥n de renta de veh√≠culos">
    <meta name="theme-color" content="#1e3c72">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Renta Veh√≠culos">
    
    <!-- Manifest -->
    <link rel="manifest" href="/static/manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/icon-192x192.png">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/icons/icon-128x128.png">
    
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Sistema de Renta de Veh√≠culos</h1>
            <p>Gestiona tu flota de veh√≠culos, clientes y rentas de forma eficiente</p>
        </header>
        
        <nav>
            <ul>
                <li><button onclick="showSection('dashboard')">Panel de Control</button></li>
                <li><button class="active" onclick="showSection('vehicles')">Veh√≠culos</button></li>
                <li><button onclick="showSection('customers')">Clientes</button></li>
                <li><button onclick="showSection('register-customer')">Registrar Cliente</button></li>
                <li><button onclick="showSection('new-rental')">Nueva Renta</button></li>
                <li><button onclick="showSection('rentals')">Historial de Rentas</button></li>
                <li><button onclick="showSection('payments')">Registrar Pago</button></li>
            </ul>
        </nav>
        
        <div class="content">
            <!-- Secci√≥n Panel de Control -->
            <div id="dashboard" class="section">
                <h2>Panel de Control</h2>
                
                <div class="stats-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="stat-card" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 10px 0; font-size: 1.1em; opacity: 0.9;">Dinero Generado</h3>
                        <p id="stat-generated" style="margin: 0; font-size: 2.5em; font-weight: bold;">$0</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 10px 0; font-size: 1.1em; opacity: 0.9;">Dinero Cobrado</h3>
                        <p id="stat-collected" style="margin: 0; font-size: 2.5em; font-weight: bold;">$0</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 10px 0; font-size: 1.1em; opacity: 0.9;">Balance Pendiente</h3>
                        <p id="stat-pending" style="margin: 0; font-size: 2.5em; font-weight: bold;">$0</p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
                        <h3 style="margin: 0 0 20px 0; color: #1e3c72;">Estad√≠sticas de Rentas</h3>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                                <span style="font-weight: 600;">Total de Rentas:</span>
                                <span id="stat-total-rentals" style="font-size: 1.3em; color: #1e3c72;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #d4edda; border-radius: 8px;">
                                <span style="font-weight: 600; color: #155724;">Rentas Activas:</span>
                                <span id="stat-active-rentals" style="font-size: 1.3em; color: #155724;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #d1ecf1; border-radius: 8px;">
                                <span style="font-weight: 600; color: #0c5460;">Rentas Completadas:</span>
                                <span id="stat-completed-rentals" style="font-size: 1.3em; color: #0c5460;">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
                        <h3 style="margin: 0 0 20px 0; color: #1e3c72;">Ingresos por Periodo</h3>
                        <div id="period-stats" style="display: flex; flex-direction: column; gap: 15px;">
                            <p style="text-align: center; color: #6c757d;">Cargando...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Secci√≥n de Veh√≠culos -->
            <div id="vehicles" class="section active">
                <h2>Gesti√≥n de Veh√≠culos</h2>
                
                <!-- Sub-navegaci√≥n de Veh√≠culos -->
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <button class="btn" onclick="showVehicleTab('available')" id="tab-available" style="margin-right: 10px; background: #667eea;">Disponibles</button>
                    <button class="btn" onclick="showVehicleTab('inventory')" id="tab-inventory" style="margin-right: 10px; background: #6c757d;">Inventario Completo</button>
                    <button class="btn" onclick="showVehicleTab('add')" id="tab-add" style="background: #6c757d;">Agregar Veh√≠culo</button>
                </div>
                
                <!-- Vista de Veh√≠culos Disponibles -->
                <div id="vehicle-available" class="vehicle-tab">
                    <h3>Veh√≠culos Disponibles</h3>
                    <div id="vehicles-grid" class="grid">
                        <div class="loading">Cargando veh√≠culos...</div>
                    </div>
                </div>
                
                <!-- Vista de Inventario Completo -->
                <div id="vehicle-inventory" class="vehicle-tab" style="display: none;">
                    <h3>Inventario Completo de Veh√≠culos</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Marca</th>
                                <th>Modelo</th>
                                <th>A√±o</th>
                                <th>Placa</th>
                                <th>Color</th>
                                <th>Kilometraje</th>
                                <th>Precio/D√≠a</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-tbody">
                            <tr>
                                <td colspan="10" class="loading">Cargando inventario...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Vista de Agregar Veh√≠culo -->
                <div id="vehicle-add" class="vehicle-tab" style="display: none;">
                    <h3>Agregar Nuevo Veh√≠culo</h3>
                    <form id="vehicle-form" onsubmit="addVehicle(event)">
                        <div class="form-group">
                            <label for="vehicle-brand">Marca:</label>
                            <input type="text" id="vehicle-brand" required placeholder="Ej: Toyota, Honda, Ford">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-model">Modelo:</label>
                            <input type="text" id="vehicle-model" required placeholder="Ej: Corolla, Civic, Focus">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-year">A√±o:</label>
                            <input type="number" id="vehicle-year" required min="1990" max="2026" placeholder="Ej: 2023">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-price">Precio por D√≠a ($):</label>
                            <input type="number" id="vehicle-price" required min="1" step="0.01" placeholder="Ej: 50.00">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-status">Estado:</label>
                            <select id="vehicle-status" required>
                                <option value="disponible">Disponible</option>
                                <option value="mantenimiento">Mantenimiento</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vehicle-plate">Placa:</label>
                            <input type="text" id="vehicle-plate" placeholder="Ej: ABC-123">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-color">Color:</label>
                            <input type="text" id="vehicle-color" placeholder="Ej: Blanco, Negro, Rojo">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-mileage">Kilometraje:</label>
                            <input type="number" id="vehicle-mileage" min="0" placeholder="Ej: 15000">
                        </div>
                        <div class="form-group">
                            <label for="vehicle-vin">VIN (N√∫mero de Identificaci√≥n):</label>
                            <input type="text" id="vehicle-vin" placeholder="Ej: 1HGBH41JXMN109186">
                        </div>
                        <button type="submit" class="btn">Agregar Veh√≠culo</button>
                    </form>
                </div>
            </div>
            
            <!-- Secci√≥n de Inventario Completo -->
            <div id="inventory" class="section">
                <h2>Inventario Completo de Veh√≠culos</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Marca</th>
                            <th>Modelo</th>
                            <th>A√±o</th>
                            <th>Placa</th>
                            <th>Color</th>
                            <th>Kilometraje</th>
                            <th>Precio/D√≠a</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody id="inventory-tbody">
                        <tr>
                            <td colspan="9" class="loading">Cargando inventario...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Secci√≥n Agregar Veh√≠culo -->
            <div id="add-vehicle" class="section">
                <h2>Agregar Nuevo Veh√≠culo</h2>
                <form id="vehicle-form" onsubmit="addVehicle(event)">
                    <div class="form-group">
                        <label for="vehicle-brand">Marca:</label>
                        <input type="text" id="vehicle-brand" required placeholder="Ej: Toyota, Honda, Ford">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-model">Modelo:</label>
                        <input type="text" id="vehicle-model" required placeholder="Ej: Corolla, Civic, Focus">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-year">A√±o:</label>
                        <input type="number" id="vehicle-year" required min="1990" max="2026" placeholder="Ej: 2023">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-price">Precio por D√≠a ($):</label>
                        <input type="number" id="vehicle-price" required min="1" step="0.01" placeholder="Ej: 50.00">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-status">Estado:</label>
                        <select id="vehicle-status" required>
                            <option value="disponible">Disponible</option>
                            <option value="mantenimiento">Mantenimiento</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vehicle-plate">Placa:</label>
                        <input type="text" id="vehicle-plate" placeholder="Ej: ABC-123">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-color">Color:</label>
                        <input type="text" id="vehicle-color" placeholder="Ej: Blanco, Negro, Rojo">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-mileage">Kilometraje:</label>
                        <input type="number" id="vehicle-mileage" min="0" placeholder="Ej: 15000">
                    </div>
                    <div class="form-group">
                        <label for="vehicle-vin">VIN (N√∫mero de Identificaci√≥n):</label>
                        <input type="text" id="vehicle-vin" placeholder="Ej: 1HGBH41JXMN109186">
                    </div>
                    <button type="submit" class="btn">Agregar Veh√≠culo</button>
                </form>
            </div>
            
            <!-- Secci√≥n de 
            <!-- Secci√≥n de Clientes -->
            <div id="customers" class="section">
                <h2>Clientes Registrados</h2>
                
                <!-- Bot√≥n para mostrar formulario -->
                <button class="btn" onclick="toggleCustomerForm()" style="margin-bottom: 20px;">
                    <span id="customer-form-toggle-text">‚ûï Agregar Nuevo Cliente</span>
                </button>
                
                <!-- Formulario de registro (oculto por defecto) -->
                <div id="customer-form-container" style="display: none; background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="margin-top: 0; color: #1e3c72;">Nuevo Cliente</h3>
                    <form id="customer-form-inline" onsubmit="registerCustomerInline(event)">
                        <div class="form-group">
                            <label for="customer-name-inline">Nombre Completo:</label>
                            <input type="text" id="customer-name-inline" required placeholder="Ej: Juan P√©rez">
                        </div>
                        <div class="form-group">
                            <label for="customer-email-inline">Email:</label>
                            <input type="email" id="customer-email-inline" required placeholder="Ej: juan@example.com">
                        </div>
                        <div class="form-group">
                            <label for="customer-phone-inline">Tel√©fono:</label>
                            <input type="tel" id="customer-phone-inline" required placeholder="Ej: 555-0123">
                        </div>
                        <div class="form-group">
                            <label for="customer-license-inline">N√∫mero de Licencia:</label>
                            <input type="text" id="customer-license-inline" required placeholder="Ej: LIC-123456">
                        </div>
                        <button type="submit" class="btn" style="margin-right: 10px;">Guardar Cliente</button>
                        <button type="button" class="btn" onclick="toggleCustomerForm()" style="background: #6c757d;">Cancelar</button>
                    </form>
                </div>
                
                <div id="customers-grid" class="grid">
                    <div class="loading">Cargando clientes...</div>
                </div>
            </div>
            
            <!-- Secci√≥n de Registro de Cliente -->
            <div id="register-customer" class="section">
                <h2>Registrar Nuevo Cliente</h2>
                <form id="customer-form" onsubmit="registerCustomer(event)">
                    <div class="form-group">
                        <label for="customer-name">Nombre Completo:</label>
                        <input type="text" id="customer-name" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-email">Correo Electr√≥nico:</label>
                        <input type="email" id="customer-email" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">Tel√©fono:</label>
                        <input type="tel" id="customer-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-license">N√∫mero de Licencia:</label>
                        <input type="text" id="customer-license" required>
                    </div>
                    <button type="submit" class="btn">Registrar Cliente</button>
                </form>
            </div>
            
            <!-- Secci√≥n de Nueva Renta -->
            <div id="new-rental" class="section">
                <h2>Crear Nueva Renta</h2>
                <form id="rental-form" onsubmit="createRental(event)">
                    <div class="form-group">
                        <label for="rental-customer">Cliente:</label>
                        <select id="rental-customer" required>
                            <option value="">Seleccionar cliente</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rental-vehicle">Veh√≠culo:</label>
                        <select id="rental-vehicle" required onchange="calculateTotal()">
                            <option value="">Seleccionar veh√≠culo</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rental-period">Periodo de Renta:</label>
                        <select id="rental-period" required onchange="calculateTotal()">
                            <option value="dia">Por D√≠a</option>
                            <option value="semana">Por Semana</option>
                            <option value="mes">Por Mes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rental-start">Fecha de Inicio:</label>
                        <input type="date" id="rental-start" required onchange="calculateTotal()">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="rental-indefinite" onchange="toggleEndDate()">
                            Fecha indefinida (sin fecha de fin establecida)
                        </label>
                    </div>
                    <div class="form-group" id="end-date-group">
                        <label for="rental-end">Fecha de Fin:</label>
                        <input type="date" id="rental-end" required onchange="calculateTotal()">
                    </div>
                    <div class="form-group">
                        <label for="rental-custom-price">Precio Total ($):</label>
                        <input type="text" id="rental-custom-price" placeholder="Precio calculado autom√°ticamente" oninput="formatPriceInput(this)">
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Dejar en blanco para usar el precio calculado autom√°ticamente</small>
                    </div>
                    <div id="rental-total" style="font-size: 1.3em; color: #667eea; font-weight: bold; margin: 20px 0;"></div>
                    <button type="submit" class="btn">Crear Renta</button>
                </form>
            </div>
            
            <!-- Secci√≥n de Historial de Rentas -->
            <div id="rentals" class="section">
                <h2>Historial de Rentas</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Veh√≠culo</th>
                            <th>Periodo</th>
                            <th>Fecha Inicio</th>
                            <th>Fecha Fin</th>
                            <th>Costo Total</th>
                            <th>Pagado</th>
                            <th>Balance</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="rentals-tbody">
                        <tr>
                            <td colspan="11" class="loading">Cargando rentas...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Secci√≥n de Pagos -->
            <div id="payments" class="section">
                <h2>Registrar Pago</h2>
                <form id="payment-form" onsubmit="registerPayment(event)">
                    <div class="form-group">
                        <label for="payment-rental">Seleccionar Renta:</label>
                        <select id="payment-rental" required onchange="updatePaymentInfo()">
                            <option value="">Seleccionar renta</option>
                        </select>
                    </div>
                    <div id="payment-info" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0; display: none;">
                        <p><strong>Costo Total:</strong> <span id="payment-total">$0.00</span></p>
                        <p><strong>Pagado:</strong> <span id="payment-paid">$0.00</span></p>
                        <p style="color: #667eea; font-size: 1.2em;"><strong>Balance Pendiente:</strong> <span id="payment-balance">$0.00</span></p>
                    </div>
                    <div class="form-group">
                        <label for="payment-amount">Monto a Pagar ($):</label>
                        <input type="number" id="payment-amount" required min="0.01" step="0.01" placeholder="Ej: 100.00">
                    </div>
                    <div class="form-group">
                        <label for="payment-method">M√©todo de Pago:</label>
                        <select id="payment-method" required>
                            <option value="">Seleccionar m√©todo</option>
                            <option value="efectivo">Efectivo</option>
                            <option value="tarjeta">Tarjeta de Cr√©dito/D√©bito</option>
                            <option value="transferencia">Transferencia Bancaria</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="payment-notes">Notas (opcional):</label>
                        <input type="text" id="payment-notes" placeholder="Ej: Pago parcial, Pago completo">
                    </div>
                    <button type="submit" class="btn">Registrar Pago</button>
                </form>
                
                <h3 style="margin-top: 40px;">Historial de Pagos</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ID Renta</th>
                            <th>Monto</th>
                            <th>M√©todo</th>
                            <th>Fecha</th>
                            <th>Notas</th>
                        </tr>
                    </thead>
                    <tbody id="payments-tbody">
                        <tr>
                            <td colspan="5" class="loading">Cargando pagos...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script src="/static/js/app.js"></script>
</body>
</html>
